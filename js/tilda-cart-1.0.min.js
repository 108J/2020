var tcart__errorHandler={show:function(t){$(".t-form__errorbox-item.js-rule-error-string").html(t),$(".js-errorbox-all").css("display","block"),$(".t-form__errorbox-item.js-rule-error-string").css("display","block")},hide:function(){$(".js-errorbox-all").css("display","none"),$("t-form__errorbox-item.js-rule-error-string").css("display","none")}},tcart__inputErrorHandler={show:function(t,e){var r=t.closest(".t-input-group");r.find(".t-input-error").html(e),r.addClass("js-error-control-box")},hide:function(t){var e=t.closest(".t-input-group");e.find(".t-input-error").html(""),e.removeClass("js-error-control-box")}};function tcart__hideDeliveryPrice(){$(".t706__cartwin-totalamount-info").length&&$(".t706__cartwin-totalamount-info").css("opacity","0")}function tcart__showDeliveryPrice(){$(".t706__cartwin-totalamount-info").length&&$(".t706__cartwin-totalamount-info").css("opacity","1")}var tcart__preloader={show:function(){$(".t706__cartwin-totalamount-wrap").before('<div class="tcart__preloader lds-ellipsis"><div></div><div></div><div></div><div></div></div>')},hide:function(){$(".tcart__preloader").remove()}},tcart_newDelivery={deliveryState:{radio:null,city:{},projectId:null,servicesFields:[],addresses:null,firstAddress:null,selectedCity:{postalCode:null,name:null},searchboxes:{},focusoutTimers:{},cityCoordinates:null,ymapApiKey:null},changeCartInputsHandler:function(){var t=$(".t706"),e=this;t.find("input").on("change",function(t){e.fillTcartDelivery()})},fillTcartDelivery:function(){var a=$(".t706");["city","street","pickup-address","pickup-id","house","entrance","floor","aptoffice","phone","entrancecode","comment","service-id","hash","postalcode"].forEach(function(t){var e="",r="delivery-"+t;switch(t){case"address":break;case"service-id":(e=a.find('[name="delivery-type"]:checked').attr("data-service-id"))&&(window.tcart.delivery[t]=e);break;case"pickup-id":(e=a.find("[data-pickup-id]").attr("data-pickup-id"))&&(window.tcart.delivery[t]=e);break;default:(e=a.find("[name="+r+"]").val())&&(window.tcart.delivery[t]=e)}})},mapAppendScript:function(t,e){var r=document.createElement("script");r.src="https://api-maps.yandex.ru/2.1/?apikey="+e+"&lang=ru_RU",$("head").append(r)},mapInit:function(t){switch(console.log("init map"),t){case"yandex":var e=document.createElement("div");e.id="delivery-yandex-map",$("#pickup-searchbox").append(e);var r=this;window.ymaps.ready(function(){window.deliveryMap=new ymaps.Map("delivery-yandex-map",{center:r.deliveryState.cityCoordinates,zoom:7,controls:["zoomControl"]})})}},mapAddPoints:function(t,e,r){var a=this,o=$(r).find(".searchbox-input");window.ymaps.ready(function(){window.deliveryMap.geoObjects.removeAll(),e.forEach(function(t){if(0!==t.coordinates[0]||0!==t.coordinates[1]){var e=new ymaps.GeoObject({geometry:{type:"Point",coordinates:t.coordinates},properties:{hintContent:t.address}},{preset:"islands#circleIcon",iconColor:"#3caa3c"});e.events.add(["click"],function(){tcart__inputErrorHandler.hide(o),a.setPostalCodeInput(t.postalCode),a.changePickupHandler(t.id,t.name,r),$('[name="delivery-pickup-address"]').val(t.name)}),window.deliveryMap.geoObjects.add(e)}})})},setPostalCodeInput:function(t){$(".t706").find('input[name="delivery-postalcode"]').val(t)},setHashInput:function(t){$(".t706").find('input[name="delivery-hash"]').val(t)},init:function(e,t){console.log("NEW DELIVERY INIT"),this.deliveryState.projectId=parseInt($("#allrecords").attr("data-tilda-project-id"),10),this.deliveryState.ymapApiKey=t,this.mapAppendScript("",t);var r=this,a=e.find(".t706__cartwin-totalamount-wrap");0<$(".t-radio__wrapper-delivery").length&&$(".t-radio__wrapper-delivery").remove();var o=document.createElement("div");o.id="newdelivery",$(o).addClass("t-radio__wrapper-delivery"),$(o).insertBefore(a);var i=tcart_newDelivery.createTitle("Доставка");$(".t-radio__wrapper-delivery").append(i);var d=tcart_newDelivery.createInput("",tcart__dict(23,"Select receiving city"),null,null,null,null,"searchbox-input","delivery-city"),c=this.createSearchbox(d,"city-searchbox"),n=tcart_newDelivery.createInput("","",null,null,null,null,"","delivery-postalcode",!0),s=tcart_newDelivery.createInput("","hash",null,null,null,null,"","delivery-hash");$(".t-radio__wrapper-delivery").append(n),$(".t-radio__wrapper-delivery").append(s),$(".t-radio__wrapper-delivery").append(c.outerHTML),this.searchboxInit("city-searchbox","city");var l=document.createElement("div");l.id="delivery-services-wrapper",$(".t-radio__wrapper-delivery").append(l),$.when(this.getCityFromGeo()).done(function(t){t&&(r.deliveryState.city=t),r.deliveryState.ymapApiKey&&r.getCityCoordinates("yandex",t.name),r.deliveryState.searchboxes["city-searchbox"]||(r.deliveryState.searchboxes["city-searchbox"]={}),r.deliveryState.searchboxes["city-searchbox"].address=t,$('input[name="delivery-city"]').val(t.name),$('input[name="delivery-city"]').attr("data-postalcode",t.postalCode),r.setPostalCodeInput(t.postalCode),r.renderServices(e,t.postalCode)}),$(document).keydown(function(t){77==t.keyCode&&console.log(r.deliveryState)});var p=document.createElement("style");p.innerHTML="body .searchbox-list-item-description {color: #716f6f;}";var u=document.querySelector("script");u.parentNode.insertBefore(p,u)},createSearchbox:function(t,e){var r=document.createElement("div");$(r).addClass("searchbox-wrapper"),$(r).attr("id",e),$(r).append(t);var a=document.createElement("div");return $(a).addClass("searchbox-list"),r.append(a),r},searchboxInit:function(t,e){var r=$("#"+t),a=$(r).find(".searchbox-input"),o=this;$(a).on("paste keyup",function(t){o.changeSearchboxInputHandler(t,r,e,void 0)}),$(a).on("focusout",function(){o.focusoutSearchboxInputHandler(r,a,e)}),$(a).on("click",function(t){o.clickSearchboxInputHandler(t,r,e,void 0)})},clickSearchboxInputHandler:function(t,e,r,a){var o=$(e).find(".searchbox-input");if(!("pickup"!==r||0<$(e).find(".searchbox-list-item").length)){e.unbind();var i=this,d=$(e).find(".searchbox-list"),c=e.attr("id");this.deliveryState.searchboxes[c]&&(this.deliveryState.searchboxes[c].autocompleteAddress=null);var n=t.target.value;if(e.hasClass("load")||(a=setTimeout(function(){e.addClass("load")},500)),"pickup"===r){var s=$(o).attr("data-service-id");$.when(i.getPickupList(i.deliveryState.projectId,i.deliveryState.city.postalCode,s,n)).done(function(t){if(clearTimeout(a),e.removeClass("load"),t.error||0===t.length)return d.html(""),void(t.error&&tcart__errorHandler.show(t.error));i.deliveryState.searchboxes[c]||(i.deliveryState.searchboxes[c]={}),i.deliveryState.searchboxes[c].autocompleteAddress=t[0],i.fillSearchList(d,t),i.choseSearchListItemHandler(e,r)})}}},changeSearchboxInputHandler:function(t,e,r,a){var o;e.unbind();var i=this,d=$(e).find(".searchbox-list"),c=$(e).find(".searchbox-input"),n=e.attr("id");switch(this.deliveryState.searchboxes[n]&&(this.deliveryState.searchboxes[n].autocompleteAddress=null,this.deliveryState.searchboxes[n].address=null),r){case"street":o="https://geoserv.tildacdn.com/api/address/";break;case"city":o="https://geoserv.tildacdn.com/api/city/";break;case"pickup":o="http://delivery.tildacdn.com/cart-api/"}var s=t.target.value,l={pattern:s,fias:this.deliveryState.city.guid};if(l=JSON.stringify(l),e.hasClass("load")||(a=setTimeout(function(){e.addClass("load")},500)),"pickup"===r){var p=$(c).attr("data-service-id");$.when(i.getPickupList(i.deliveryState.projectId,i.deliveryState.city.postalCode,p,s)).done(function(t){if(clearTimeout(a),e.removeClass("load"),t.error||0===t.length)return d.html(""),void(t.error&&tcart__errorHandler.show(t.error));i.deliveryState.searchboxes[n]||(i.deliveryState.searchboxes[n]={}),i.deliveryState.searchboxes[n].autocompleteAddress=t[0],i.fillSearchList(d,t),i.choseSearchListItemHandler(e,r)})}else fetch(o,{body:l,method:"post"}).then(function(t){return t.json()}).then(function(t){clearTimeout(a),e.removeClass("load"),t.error||0===t.length?d.html(""):(console.log(t),i.deliveryState.searchboxes[n]||(i.deliveryState.searchboxes[n]={}),i.deliveryState.searchboxes[n].autocompleteAddress=t[0],i.fillSearchList(d,t),i.choseSearchListItemHandler(e,r))})},choseSearchListItemHandler:function(e,t){var r,a,o,i=$(".t706"),d=e.attr("id"),c=$(e).find(".searchbox-input"),n=$(e).find(".searchbox-list"),s=$(e).find(".searchbox-list-item"),l=this;switch(tcart__inputErrorHandler.hide(c),t){case"city":s.on("click",function(t){tcart__errorHandler.hide(),a=l.deliveryState.focusoutTimers[d],clearTimeout(a),r=parseInt(t.target.dataset.postalcode,10),l.setPostalCodeInput(r),c.val(t.target.dataset.name),c.attr("data-postalcode",t.target.dataset.postalcode),c.attr("data-guid",t.target.dataset.guid),l.deliveryState.ymapApiKey&&l.getCityCoordinates("yandex",t.target.dataset.name),l.deliveryState.searchboxes[d]||(l.deliveryState.searchboxes[d]={}),l.deliveryState.searchboxes[d].address={name:t.target.dataset.name,postalCode:t.target.dataset.postalcode,guid:t.target.dataset.guid},l.deliveryState.city={name:t.target.dataset.name,fullName:t.target.dataset.fullName,postalCode:t.target.dataset.postalcode,guid:t.target.dataset.guid},n.html(""),$("#delivery-services-wrapper").html(""),l.renderServices(i,r)});break;case"street":s.on("click",function(t){a=l.deliveryState.focusoutTimers[d],clearTimeout(a),o=parseInt(c.attr("data-service-id")),r=parseInt(t.target.dataset.postalcode,10),c.val(t.target.dataset.shortname),c.attr("data-postalcode",t.target.dataset.postalcode),c.attr("data-guid",t.target.dataset.guid),n.html(""),l.deliveryState.searchboxes[d]||(l.deliveryState.searchboxes[d]={}),l.deliveryState.searchboxes[d].address={name:t.target.dataset.name,shortName:t.target.dataset.shortname,postalCode:t.target.dataset.postalcode,guid:t.target.dataset.guid},l.setPostalCodeInput(t.target.dataset.postalcode),$.when(l.getDeliveryPrice(l.deliveryState.projectId,r,o)).done(function(t){if(t.error&&console.log(t.error),t.hash&&l.setHashInput(t.hash),t.price){var e=t.price;l.updatePriceValueInRadio(e,o)}})});break;case"pickup":s.on("click",function(t){a=l.deliveryState.focusoutTimers[d],clearTimeout(a),l.changePickupHandler(t.target.dataset.pickupid,t.target.dataset.name,e),l.deliveryState.searchboxes[d]||(l.deliveryState.searchboxes[d]={}),l.deliveryState.searchboxes[d].address={name:t.target.dataset.name,pickupid:t.target.dataset.pickupid,postalCode:t.target.dataset.postalCode},l.setPostalCodeInput(t.target.dataset.postalcode)})}},fillSearchList:function(t,e){var a,o=document.createElement("div");e.forEach(function(t){var e=document.createElement("div");$(e).addClass("searchbox-list-item t-text"),e.dataset.name=t.name,e.dataset.postalcode=t.postalCode,e.dataset.guid=t.guid||"",e.dataset.pickupid=t.id||"",e.dataset.shortname=t.shortName||"";var r=document.createElement("div");r.classList.add("searchbox-list-item-text"),r.innerHTML=t.name,e.append(r),t.fullName&&((a=document.createElement("div")).classList.add("searchbox-list-item-description"),a.innerHTML=t.fullName,e.append(a)),t.address&&((a=document.createElement("div")).classList.add("searchbox-list-item-description"),a.innerHTML=t.address,e.append(a)),o.append(e)}),t.html(o.outerHTML)},focusoutSearchboxInputHandler:function(t,e,a){var o,i,d=this,c=$(t).find(".searchbox-list"),n=$(".t706"),s=t.attr("id");this.deliveryState.focusoutTimers[s]=setTimeout(function(){switch(a){case"city":d.deliveryState.searchboxes[s].address?(tcart__inputErrorHandler.hide(e),c.html("")):d.deliveryState.searchboxes[s].autocompleteAddress?(i=d.deliveryState.searchboxes[s].autocompleteAddress,d.deliveryState.searchboxes[s].address=i,tcart__inputErrorHandler.hide(e),d.deliveryState.ymapApiKey&&d.getCityCoordinates("yandex",i.name),o=parseInt(i.postalCode,10),d.setPostalCodeInput(o),$(e).val(i.name),$(e).attr("data-postalcode",i.postalCode),$(e).attr("data-guid",i.guid),console.log("focusout"),d.deliveryState.city.name=i.name,d.deliveryState.city.fullName=i.fullName,d.deliveryState.city.postalCode=o,d.deliveryState.city.guid=i.guid,c.html(""),$("#delivery-services-wrapper").html(""),d.renderServices(n,o)):(tcart__inputErrorHandler.show(e,"Не удается найти адрес в базе"),$(e).val(""),$("#delivery-services-wrapper").html(""),$("#addresses-wrapper").remove());break;case"street":if(d.deliveryState.searchboxes[s]&&d.deliveryState.searchboxes[s].address)tcart__inputErrorHandler.hide(e),c.html("");else if(d.deliveryState.searchboxes[s].autocompleteAddress){i=d.deliveryState.searchboxes[s].autocompleteAddress,d.deliveryState.searchboxes[s].address=i,tcart__inputErrorHandler.hide(e),o=parseInt(i.postalCode,10),$(e).val(i.shortName),$(e).attr("data-postalcode",o),$(e).attr("data-guid",i.guid),d.setPostalCodeInput(o),c.html("");var r=parseInt($(e).attr("data-service-id"));$.when(d.getDeliveryPrice(d.deliveryState.projectId,o,r)).done(function(t){if(t.error,t.hash&&d.setHashInput(t.hash),t.price){var e=t.price;d.updatePriceValueInRadio(e,r)}})}else tcart__inputErrorHandler.show(e,"Не удается найти адрес в базе"),$(e).val("");break;case"pickup":c.html(""),d.deliveryState.searchboxes[s].address?(tcart__inputErrorHandler.hide(e),c.html("")):d.deliveryState.searchboxes[s].autocompleteAddress?(i=d.deliveryState.searchboxes[s].autocompleteAddress,d.deliveryState.searchboxes[s].address=i,tcart__inputErrorHandler.hide(e),d.changePickupHandler(i.id,i.name,t),d.setPostalCodeInput(i.postalCode),c.html("")):(tcart__inputErrorHandler.show(e,"Не удается найти адрес в базе"),$(e).val(""))}},200)},renderServices:function(t,e){$("#addresses-wrapper").remove();var r=e||"",c=this;$.when(this.getServices(this.deliveryState.projectId,r)).done(function(t){t.error?tcart__errorHandler.show(t.error):(t.forEach(function(t,e){c.deliveryState.servicesFields[t.id]=t.fields;var r,a=t.hint||"",o=t.title||"",i=t.minimumPrice||"";r=t.staticPrice?t.staticPrice+" рублей":"от "+t.minimumDeliverTime+" дня от "+t.minimumPrice+" рублей","delivery"===t.type&&(i="");var d=tcart_newDelivery.createRadio(o,r,i,t.type,null,t.id,e,t.staticPrice,a,t.hash);$("#delivery-services-wrapper").append(d)}),tcart_newDelivery.changeDeliveryTypeListener(),$('#delivery-services-wrapper [checked="checked"]').trigger("change"),tcart__showDeliveryPrice())})},getCityFromGeo:function(){return $.ajax({type:"POST",url:"https://geoserv.tildacdn.com/api/detect-city/",dataType:"json",success:function(){},error:function(t){console.log(t)}})},getServices:function(t,e){console.log("%crequest: services","color: yellow");var r={action:"list",projectId:t,postalCode:e};return r=JSON.stringify(r),tcart__preloader.show(),tcart__hideDeliveryPrice(),$.ajax({type:"POST",url:"http://delivery.tildacdn.com/cart-api/",data:r,dataType:"json",success:function(t){console.log("%cservices from API","color: lightgreen",t),tcart__preloader.hide()},error:function(t){console.log(t),tcart__preloader.hide()}})},getPickupList:function(t,e,r,a){console.log("%crequest: pickup list","color: yellow");var o={action:"pickup-list",projectId:t,postalCode:e,deliveryId:r,pattern:a};return o=JSON.stringify(o),$.ajax({type:"POST",url:"http://delivery.tildacdn.com/cart-api/",data:o,dataType:"json",success:function(t){console.log("%cpickupList from API","color: lightgreen",t)},error:function(t){console.log(t)}})},getDeliveryPrice:function(t,e,r){console.log("%crequest: delivery price","color: yellow"),tcart__hideDeliveryPrice();var a={action:"calculate",projectId:t,postalCode:e,deliveryId:r};return a=JSON.stringify(a),$.ajax({type:"POST",url:"http://delivery.tildacdn.com/cart-api/",data:a,dataType:"json",success:function(t){console.log("%cdelivery price form API","color: lightgreen",t.price)},error:function(t){console.log(t)}})},getCityCoordinates:function(t,e){console.log("%crequest: city coordinates","color: yellow");var r=this;fetch("https://geocode-maps.yandex.ru/1.x/?apikey="+this.deliveryState.ymapApiKey+"&format=json&geocode="+e).then(function(t){return t.json()}).then(function(t){var e;try{(e=t.response.GeoObjectCollection.featureMember[0].GeoObject.Point.pos.split(" "))&&(e=[e[1],e[0]],r.deliveryState.cityCoordinates=e,console.log("%ccity coordinates form API","color: lightgreen",e))}catch(t){console.log(t)}})},createInput:function(t,e,r,a,o,i,d,c,n){r=r||"",a=a||"";var s="";return s+="<div "+(n?"hidden":"")+' class="t-input-group t-input-group_in" data-input-lid="">',s+='<div class="t-input-title t-descr t-descr_md" data-redactor-toolbar="no" field="">'+(e=e||"")+"</div>",s+='<div class="t-input-block">',s+='<input class="'+(d=d+" t-input js-tilda-rule"||"t-input js-tilda-rule")+'"  '+(t?'type="'+t+'"':"")+' data-service-id="'+(i=i||"")+'" '+((o=o||"")?'id="'+o+'"':"")+' name="'+c.toLowerCase()+'" value="'+a+'" placeholder="'+r+'" autocomplete="off" data-tilda-req="1" style="color:#000000; border:1px solid #000000; background-color:#ffffff;">',s+='<div class="t-input-error"></div>',s+="</div>",s+="</div>"},createRadio:function(t,e,r,a,o,i,d,c,n,s){var l="";0===d&&(l='checked="checked"');var p="";return p+='<label class="t-radio__control t-text t-text_xs '+o+'">',p+="<input  "+((s=s||"")?'data-hash-value="'+s+'"':"")+" "+((n=n||"")?'data-hint-text="'+n+'"':"")+" "+(c?'data-static-price="'+c+'"':"")+" "+(c?'data-delivery-price="'+c+'"':"")+" "+l+' data-service-id="'+i+'" type="radio" data-delivery-type='+a+' name="delivery-type" value="'+(t=t||"")+'" class="t-radio t-radio_delivery js-tilda-rule" data-tilda-req="1">',p+='<div class="t-radio__indicator" style="border-color:#000000"></div>',p+='<span class="delivery-checkbox-label">'+t+" </span>",p+='<span class="delivery-minimum">'+(e=e||"")+" </span>",p+="</label>"},createTitle:function(t,e){var r="";return r+='<div class="t-name t-name_md'+(e=e||"")+'" style="margin: 20px 0;">'+(t=t||"")+"</div>"},createSelect:function(t,e,r,a,o){var i="";return i+='<label class="t-input-title t-descr t-descr_md">Пункт выдачи</label>',i+='<div class="ss-select delivery-pickup-select">',i+='<select class="ss-input ss-select delivery-select" data-service-id="'+a+'" name="'+(o=o||"")+'">',i+='<option data-point-id="">Не выбран</option>',r.forEach(function(t){i+="<option data-point-id="+t.id+">"+t.address+"</option>"}),i+="</select>",i+="</div>"},changeDeliveryTypeListener:function(){var t=this;$("input[data-delivery-type]").change(function(){tcart__errorHandler.hide(),t.renderAddressFields(this),console.log(this.dataset.hashValue),this.dataset.hashValue&&t.setHashInput(this.dataset.hashValue),$("input[data-delivery-type]").each(function(t,e){0<$(e).attr("data-static-price")?$(e).attr("data-delivery-price",$(e).attr("data-static-price")):$(e).attr("data-delivery-price","")}),t.hints.deleteAll(),$(this).attr("data-hint-text")&&t.hints.render($(this).attr("data-hint-text")),tcart__updateDelivery()})},updatePriceValueInRadio:function(t,e){$('.t706__cartwin input[data-service-id="'+e+'"]').attr("data-delivery-price",t),tcart__updateDelivery(),tcart__showDeliveryPrice()},changePickupHandler:function(r,t,e){var a=$(e).find(".searchbox-input"),o=$(e).find(".searchbox-list"),i=a.attr("data-service-id"),d=this;a.attr("data-pickup-id",r),a.val(t),$.when(d.getDeliveryPrice(d.deliveryState.projectId,d.deliveryState.city.postalCode,i)).done(function(t){var e=t.price;t.hash&&d.setHashInput(t.hash),r||(e=0),d.updatePriceValueInRadio(e,i)}),o.html("")},renderAddressFields:function(t){var a=this;0<$("#addresses-wrapper").length&&$("#newdelivery").attr("data-service-id")!==$(t).attr("data-service-id")&&$("#addresses-wrapper").remove(),$("#newdelivery").attr("data-service-id",$(t).attr("data-service-id"));var o=document.createElement("div");o.id="addresses-wrapper",$(o).css("margin","20px 0"),$(".t-radio__wrapper-delivery").append(o);var e=$(t).attr("data-delivery-type"),i=$(t).attr("data-service-id");switch(e){case"pickup":$.when(a.getPickupList(a.deliveryState.projectId,a.deliveryState.city.postalCode,i)).done(function(t){if(t.error)tcart__errorHandler.show(t.error);else{var e=a.createInput("",tcart__dict(24,"Select pickup location"),null,null,null,i,"searchbox-input","delivery-pickup-address"),r=a.createSearchbox(e,"pickup-searchbox");$("#addresses-wrapper").append(r.outerHTML),a.deliveryState.ymapApiKey&&a.mapInit("yandex"),a.searchboxInit("pickup-searchbox","pickup",null,t),a.renderUserFields(o,i),a.changeCartInputsHandler(),a.deliveryState.ymapApiKey&&a.mapAddPoints("",t,r)}});break;case"delivery":a.renderUserFields(o,i),a.changeCartInputsHandler()}},renderUserFields:function(t,e){var r=this.deliveryState.servicesFields[e];for(var a in r){var o=r[a].autocomplete,i="";switch(a){case"street":i=tcart__dict(15,"Street");break;case"house":i=tcart__dict(16,"House");break;case"entrance":i=tcart__dict(17,"Entrance");break;case"floor":i=tcart__dict(18,"Floor");break;case"aptOffice":i=tcart__dict(19,"AptOffice");break;case"phone":i=tcart__dict(20,"Phone");break;case"entranceCode":i=tcart__dict(21,"EntranceCode");break;case"comment":i=tcart__dict(22,"Comment")}i=i||"";var d="delivery-"+a;if(o&&"house"!==a){var c=tcart_newDelivery.createInput("",i,null,"","",e,"searchbox-input",d),n=a+"-searchbox",s=this.createSearchbox(c,n);$(t).append(s),this.searchboxInit(n,a)}else{var l=tcart_newDelivery.createInput("",i,null,"","",e,"",d);$(t).append(l)}}},hints:{render:function(t){var e=$("#delivery-services-wrapper"),r=document.createElement("div");$(r).addClass("delivery-hint t-text t-text_xs"),r.innerHTML=t,e.append(r)},deleteAll:function(){$(".delivery-hint").length&&$(".delivery-hint").remove()}}};function tcart__init(t,e){var r=$(".t706");if(void 0!==window.tcart_initted&&"yes"==window.tcart_initted&&1<r.length){$(".t706__previewmode-infobox center").append('<div style="color:red;">Error: Two cart widgets on the page</div>')}else{var a=r.attr("data-cart-dontstore");void 0!==a&&"y"==a&&(window.tcart_dontstore="y"),void 0!==(a=r.attr("data-cart-oneproduct"))&&"y"==a&&(window.tcart_oneproduct="y"),void 0!==(a=r.attr("data-cart-maxstoredays"))&&""!=a&&0<=a&&(window.tcart_maxstoredays=a),void 0!==(a=r.attr("data-cart-sendevent-onadd"))&&"y"==a&&(window.tcart_sendevent_onadd="y"),window.tcart_initted="yes",tcart__drawBottomTotalAmount(),tcart__loadLocalObj(e),tcart__reDrawCartIcon(),tcart__addEvent__links(),setInterval(function(){tcart__addEvent__links()},5e3),tcart__addEvents(),tcart__addEvent__selectpayment(),$("#rec"+t).attr("data-animationappear","off"),$("#rec"+t).css("opacity","1"),window.tildaBrowserLang=window.navigator.userLanguage||window.navigator.language,window.tildaBrowserLang=window.tildaBrowserLang.toUpperCase(),-1!=window.tildaBrowserLang.indexOf("RU")?window.tildaBrowserLang="RU":-1!=window.tildaBrowserLang.indexOf("FR")?window.tildaBrowserLang="FR":-1!=window.tildaBrowserLang.indexOf("DE")?window.tildaBrowserLang="DE":-1!=window.tildaBrowserLang.indexOf("ES")?window.tildaBrowserLang="ES":-1!=window.tildaBrowserLang.indexOf("PT")?window.tildaBrowserLang="PT":-1!=window.tildaBrowserLang.indexOf("UK")?window.tildaBrowserLang="UK":-1!=window.tildaBrowserLang.indexOf("JA")?window.tildaBrowserLang="JA":-1!=window.tildaBrowserLang.indexOf("CN")?window.tildaBrowserLang="CN":window.tildaBrowserLang="EN",r.find(".t-input-group_dl").length?($(".t706__cartwin-prodamount-label").html(tcart__dict(2,"Subtotal")+":&nbsp;"),$(".t706__cartwin-totalamount-label").html(tcart__dict(3,"Total")+":&nbsp;")):($(".t706__cartwin-prodamount-label").html(tcart__dict(1,"Total")+":&nbsp;"),$(".t706__cartwin-totalamount-label").html(tcart__dict(1,"Total")+":&nbsp;")),""==$(".t706__cartwin-heading").html()&&$(".t706__cartwin-heading").html(tcart__dict(4,"Your order")+":"),"Submit"==$(".t706 .t-form__submit .t-submit").html()&&$(".t706 .t-form__submit .t-submit").html(tcart__dict(5,"Submit order")),r.find(".t-input-group_pm").length&&r.find(".t-input-group_pm").find(".t-input-title").html(tcart__dict(6,"Payment method"))}}function tcart__dict(t){var e=[],r={EN:"Total",RU:"Сумма",FR:"Total",DE:"Gesamtsumme",ES:"Total",PT:"Total",UK:"Сума",JA:"合計",CN:"总额。"};e[1]=r,(r={}).EN="Subtotal",r.RU="Сумма",r.FR="Sous-total",r.DE="Zwischensumme",r.ES="Subtotal",r.PT="Subtotal",r.UK="Сума",r.JA="小計",r.CN="小计。",e[2]=r,(r={}).EN="Total",r.RU="Итоговая сумма",r.FR="Total",r.DE="Gesamtsumme",r.ES="Total",r.PT="Total",r.UK="Підсумкова сума",r.JA="合計",r.CN="总额。",e[3]=r,(r={}).EN="Your order",r.RU="Ваш заказ",r.FR="Votre commande",r.DE="Ihre Bestellung",r.ES="Su pedido",r.PT="Seu pedido",r.UK="Ваше замовлення",r.JA="注文済",r.CN="你的订货。",e[4]=r,(r={}).EN="Submit order",r.RU="Оформить заказ",r.FR="Commander",r.DE="Bestellung abschicken",r.ES="Enviar pedido",r.PT="Enviar pedido",r.UK="Оформити замовлення",r.JA="注文を確定",r.CN="办妥订货。",e[5]=r,(r={}).EN="Payment method",r.RU="Способ оплаты",r.FR="Mode de paiement",r.DE="Zahlungsmethode",r.ES="Método de pago",r.PT="Método de pagamento",r.UK="Спосіб оплати",r.JA="支払方法",r.CN="付款方式。",e[6]=r,(r={}).EN="Click to order\t",r.RU="Оформить заказать",r.FR="Commander",r.DE="Bestellung abschicken",r.ES="Enviar pedido",r.PT="Enviar pedido",r.UK="Оформити замовлення",r.JA="注文を確定",r.CN="提交订单。",e[7]=r,(r={}).EN="Subtotal with discount",r.RU="Сумма со скидкой",r.FR="Sous-total avec remise",r.DE="Zwischensumme mit Rabatt",r.ES="Subtotal con descuento",r.PT="Subtotal com desconto",r.UK="Сума зі знижкою",r.JA="割引後小計",r.CN="减价同小计。",e[8]=r,(r={}).EN="Promo code",r.RU="Промокод",r.FR="Code promo",r.DE="Aktionscode",r.ES="Código promocional",r.PT="Código promocional",r.UK="Промокод",r.JA="プロモコード",r.CN="促销代码。",e[9]=r,(r={}).EN="Discount",r.RU="Скидка",r.FR="Remise",r.DE="Rabatt",r.ES="Descuento",r.PT="Desconto",r.UK="Знижка",r.JA="割引",r.CN="减价。",e[10]=r,(r={}).EN="Minimal order",r.RU="Минимальный заказ",r.FR="Commande minimale",r.DE="Minimale Bestellung",r.ES="Pedido mínimo",r.PT="Pedido mínimo",r.UK="Мінімальне замовлення",r.JA="最小注文価格",r.CN="最小的订货。",e[11]=r,(r={}).EN="Minimal order quantity",r.RU="Минимальное количество в заказе",r.FR="Quantité de commande minimale",r.DE="Mindestbestellmenge",r.ES="Cantidad mínima del pedido",r.PT="Quantidade mínima por pedido",r.UK="Мінімальна кількість у замовленні",r.JA="最小注文数",r.CN="最小的总数。",e[12]=r,(r={}).EN="Sorry, limit has been reached. This is the maximum quantity of goods in stock",r.RU="Извините, достигнут лимит. Это максимально возможное количество товаров в наличии",e[13]=r,(r={}).EN="free",r.RU="бесплатно",r.FR="gratuit",r.DE="kostenlos",r.ES="gratis",r.PT="livre",r.UK="безкоштовно",r.JA="無料で",r.CN="免费",e[14]=r,(r={}).EN="Street",r.RU="Улица",e[15]=r,(r={}).EN="House",r.RU="Дом",e[16]=r,(r={}).EN="Entrance",r.RU="Подъезд",e[17]=r,(r={}).EN="Floor",r.RU="Этаж",e[18]=r,(r={}).EN="AptOffice",r.RU="Квартира/офис",e[19]=r,(r={}).EN="Phone",r.RU="Телефон",e[20]=r,(r={}).EN="EntranceCode",r.RU="Домофон",e[21]=r,(r={}).EN="Comment",r.RU="Комментарий",e[22]=r,(r={}).EN="Select receiving city",r.RU="Выберите город получения",e[23]=r,(r={}).EN="Select pickup location'",r.RU="Выберите пункт получения",e[24]=r;var a=window.tildaBrowserLang;if(null!=typeof e[t])return void 0!==e[t][a]&&typeof e[t][a]?e[t][a]:e[t].EN}function tcart__nullObj(){var t={products:[],prodamount:0,amount:0,system:""};return t}function tcart__loadLocalObj(t){var e=null;if("object"==typeof localStorage)try{e=localStorage.getItem("tcart")}catch(t){console.log("Your web browser does not support storing a Cart data locally.")}if(window.tcart=null===e?tcart__nullObj():JSON.parse(e),void 0!==window.tcart_maxstoredays&&""!=window.tcart_maxstoredays){var r=window.tcart_maxstoredays;0<r?void 0!==window.tcart.updated&&0<window.tcart.updated&&86400*r<Math.floor(Date.now()/1e3)-window.tcart.updated&&(window.tcart=tcart__nullObj()):"0"==r&&(window.tcart=tcart__nullObj())}else void 0!==window.tcart.updated&&0<window.tcart.updated&&2592e3<Math.floor(Date.now()/1e3)-window.tcart.updated&&(window.tcart=tcart__nullObj());void 0!==window.tcart_dontstore&&"y"==window.tcart_dontstore&&(window.tcart=tcart__nullObj()),delete window.tcart.currency,delete window.tcart.currency_txt,delete window.tcart.currency_txt_l,delete window.tcart.currency_txt_r,delete window.tcart.currency_side,delete window.tcart.currency_sep,delete window.tcart.currency_dec,window.tcart.currency="$",window.tcart.currency_side="l",window.tcart.currency_sep=".",window.tcart.currency_dec="",void 0!==window.tcart.delivery&&delete window.tcart.delivery,void 0!==window.tcart.promocode&&delete window.tcart.promocode;var a=$(".t706").attr("data-project-currency");void 0!==a&&""!=a&&(window.tcart.currency=a),window.tcart.currency_txt=window.tcart.currency,void 0!==(a=$(".t706").attr("data-project-currency-side"))&&"r"==a&&(window.tcart.currency_side="r"),"l"==window.tcart.currency_side?(window.tcart.currency_txt_l=window.tcart.currency_txt+"",window.tcart.currency_txt_r=""):(window.tcart.currency_txt_r="&nbsp;"+window.tcart.currency_txt,window.tcart.currency_txt_l=""),void 0===(a=$(".t706").attr("data-project-currency-sep"))||"."!=a&&","!=a?"$"==window.tcart.currency||"€"==window.tcart.currency||"USD"==window.tcart.currency||"EUR"==window.tcart.currency?window.tcart.currency_sep=".":window.tcart.currency_sep=",":window.tcart.currency_sep=a,a=$(".t706").attr("data-project-currency-dec"),window.tcart.currency_dec=void 0!==a&&"00"==a?a:"",delete window.tcart.system;var o=$(".t706").attr("data-payment-system");window.tcart.system=void 0!==o&&""!=o?o:"none";var i=$(".t706").attr("data-cart-minorder");void 0!==i&&""!=i&&0<i&&void 0===window.tcart_minorder&&(i=+i,window.tcart_minorder=i,$(".t706__cartwin-prodamount-wrap").prepend('<div class="t706__cartwin-prodamount-minorder" style="opacity:0.5; font-size:14px; font-weight:400;">'+tcart__dict(11,"Minimum order")+": "+tcart__showPrice(i)+"</div>"));var d=$(".t706").attr("data-cart-mincntorder");void 0!==d&&""!=d&&0<d&&void 0===window.tcart_mincntorder&&(d=+d,window.tcart_mincntorder=d,$(".t706__cartwin-prodamount-wrap").prepend('<div class="t706__cartwin-prodamount-mincntorder" style="opacity:0.5; font-size:14px; font-weight:400;">'+tcart__dict(12,"Minimal quantity")+": "+d+"</div>"));var c=$(".t706");-1!==window.location.href.indexOf("newdelivery=yes")&&tcart_newDelivery.init(c,t),tcart__addDelivery(),tcart__updateTotalProductsinCartObj()}function tcart__saveLocalObj(){if(!(void 0!==window.tcart_dontstore&&"y"==window.tcart_dontstore||void 0!==window.tcart_maxstoredays&&0==window.tcart_maxstoredays||"object"!=typeof window.tcart)){window.tcart.updated=Math.floor(Date.now()/1e3);var t=JSON.stringify(window.tcart);if("object"==typeof localStorage)try{localStorage.setItem("tcart",t)}catch(t){console.log("Your web browser does not support storing a Cart data locally.")}}}function tcart__syncProductsObject__LStoObj(){if(!(void 0!==window.tcart_dontstore&&"y"==window.tcart_dontstore||void 0!==window.tcart_maxstoredays&&0==window.tcart_maxstoredays||"object"!=typeof localStorage))try{var t=localStorage.getItem("tcart"),e=JSON.parse(t);"object"==typeof e.products&&(window.tcart.products=e.products,tcart__updateTotalProductsinCartObj())}catch(t){}}function tcart__addEvents(){$(".t706__carticon").click(function(){tcart__openCart()}),$(".t706__cartwin-close").click(function(){tcart__closeCart()}),$(".t706__cartwin-closebtn").click(function(){tcart__closeCart()}),$(".t706").find(".js-form-proccess").attr("data-formcart","y"),$(".t706__cartwin").mousedown(function(t){if(t.target==this){var e=$(window).width()-17;if(t.clientX>e)return;tcart__closeCart()}})}function tcart__addEvent__links(){$('[href^="#order"]').not("[data-link-event-setted]").click(function(t){t.preventDefault();var e=$(this);if(e.attr("data-link-event-setted","yes"),void 0===e.attr("data-dbclk-prevent")||"yes"!=e.attr("data-dbclk-prevent")){e.attr("data-dbclk-prevent","yes"),setTimeout(function(){e.removeAttr("data-dbclk-prevent")},1e3),$("body").hasClass("t-body_popupshowed")&&($("body").removeClass("t-body_popupshowed"),$(".t-popup").removeClass("t-popup_show"),setTimeout(function(){$(".t-popup").not(".t-popup_show").css("display","none")},300),tcart__clearProdUrl());var r=e.attr("href"),a="0",o="",i="",d="",c="",n="",s="",l="";if("#order:"==r.substring(0,7)){var p=r.substring(7);if(void 0!==p&&""!=p){if(0<p.indexOf(":::")){var u=p.indexOf(":::");if(0<p.indexOf("=")&&p.indexOf("=")<p.indexOf(":::")){var _=p.substring(u+3);p=p.substring(0,u)}}var w;if(0<p.indexOf("="))void 0!==(w=p.split("="))[0]&&(o=w[0]),void 0!==w[1]&&(a=w[1]),a=tcart__cleanPrice(a);else o=p;if(void 0!==_&&""!=_)if(0<_.indexOf("="))void 0!==(w=_.split("="))[0]&&void 0!==w[1]&&""!=w[0]&&""!=w[1]&&"image"==w[0]&&0<w[1].indexOf("tildacdn.com")&&(i=w[1]);""==s&&void 0===(s=e.closest(".r").attr("id").replace("rec",""))&&(s="")}}var v=$(this).closest(".js-product");if(void 0!==v){if(""==o&&void 0===(o=v.find(".js-product-name").text())&&(o=""),""!=a&&0!=a||(a=tcart__cleanPrice(a=v.find(".js-product-price").text())),""==i)if(void 0!==v.attr("data-product-img")&&""!=v.attr("data-product-img"))i=v.attr("data-product-img");else{var m=v.find(".js-product-img");if(void 0!==m&&(m.is("img")&&(i=m.attr("src")),m.is("div"))){i="";var y=m.css("background-image");void 0!==y&&""!=y&&(i=y.replace("url(","").replace(")","").replace(/\"/gi,""))}}""==c&&void 0===(c=v.attr("data-product-lid"))&&(c=""),""==n&&void 0===(n=v.attr("data-product-uid"))&&(n=""),""==s&&void 0===(s=v.closest(".r").attr("id").replace("rec",""))&&(s=""),""==l&&void 0===(l=v.attr("data-product-inv"))&&(l="");var h=[];v.find(".js-product-edition-option").each(function(){var t=$(this),e=t.find(".js-product-edition-option-name").text(),r=t.find("option:selected").val(),a=t.find("option:selected").attr("data-product-edition-variant-price");if(a=tcart__cleanPrice(a),void 0!==e&&void 0!==r){var o={};""!=e&&(e=tcart__escapeHtml(e)),""!=r&&(r=(r=tcart__escapeHtml(r)).replace(/(?:\r\n|\r|\n)/g,"")),1<e.length&&":"==e.charAt(e.length-1)&&(e=e.substring(0,e.length-1)),o.option=e,o.variant=r,o.price=a,h.push(o)}}),v.find(".js-product-option").each(function(){var t=$(this),e=t.find(".js-product-option-name").text(),r=t.find("option:selected").val(),a=t.find("option:selected").attr("data-product-variant-price");if(a=tcart__cleanPrice(a),void 0!==e&&void 0!==r){var o={};""!=e&&(e=tcart__escapeHtml(e)),""!=r&&(r=(r=tcart__escapeHtml(r)).replace(/(?:\r\n|\r|\n)/g,"")),1<e.length&&":"==e.charAt(e.length-1)&&(e=e.substring(0,e.length-1)),o.option=e,o.variant=r,o.price=a,h.push(o)}}),""==d&&void 0===(d=v.find(".js-product-sku").text())&&(d="")}if(""!=o||""!=a&&0!=a){""==o&&(o="NoName"),""==a&&(a=0),""!=o&&(o=tcart__escapeHtml(o)),""!=i&&(i=tcart__escapeHtmlImg(i));var f={};if(f.name=o,f.price=a,f.img=i,f.recid=s,f.lid=c,void 0!==h&&0<h.length&&(f.options=h),void 0!==d&&""!=d&&(d=tcart__escapeHtml(d),f.sku=d),void 0!==n&&""!=n&&(f.uid=n),void 0!==c&&""!=c&&(f.lid=c),void 0!==l&&0<l&&(f.inv=parseInt(l,10)),tcart__addProduct(f),void 0!==window.tcart_sendevent_onadd&&"y"==window.tcart_sendevent_onadd&&window.Tilda&&"function"==typeof Tilda.sendEventToStatistics){var b="/tilda/cart/add/";0<s&&(b+=s),0<c&&(b+="-"+c);var g=o,x=a,S="";void 0!==h&&0<h.length&&$.each(h,function(t,e){S+=e.option+": "+e.variant+"; "});var C={ecommerce:{add:{products:[{recid:s,lid:c,sku:d,name:o,price:a,variant:S,quantity:1}]}}};Tilda.sendEventToStatistics(b,g,C,x)}}}})}function tcart__addProduct(o){var i=Math.floor(Date.now()/1e3);tcart__syncProductsObject__LStoObj();var t=window.tcart.products,d="";0<t.length&&$.each(t,function(t,e){if(void 0!==window.tcart_oneproduct&&"y"==window.tcart_oneproduct){if(e.name==o.name&&e.price==o.price){if(void 0===e.options&&void 0===o.options&&void 0===e.sku&&void 0===o.sku)return!(d="yes");if(void 0===e.options&&void 0===o.options&&void 0!==e.sku&&void 0!==o.sku&&e.sku==o.sku)return!(d="yes")}}else if(e.name==o.name&&e.price==o.price){var r="y",a="";if("object"==typeof e.options&&"object"==typeof o.options&&$.each(e.options,function(t,e){if("object"==typeof e&&"object"==typeof o.options[t]){if(e.option!==o.options[t].option||e.variant!==o.options[t].variant||e.price!==o.options[t].price)return r=!1}else if(void 0===e||void 0===o.options[t])return r=!1}),(void 0===e.sku&&void 0===o.sku||e.sku==o.sku)&&(a="y"),"y"==r&&"y"==a)return 0<window.tcart.products[t].quantity&&void 0!==o.inv&&0<o.inv&&window.tcart.products[t].quantity==o.inv?alert(tcart__dict(13,"Sorry, limit reached, this is the maximum quantity of goods in stock")):(window.tcart.products[t].quantity++,window.tcart.products[t].amount=window.tcart.products[t].price*window.tcart.products[t].quantity,window.tcart.products[t].amount=tcart__roundPrice(window.tcart.products[t].amount),window.tcart.products[t].ts=i),!(d="yes")}}),""==d&&(o.amount=o.price,o.quantity=1,o.ts=i,window.tcart.products.push(o)),tcart__updateTotalProductsinCartObj(),tcart__reDrawCartIcon(),tcart__saveLocalObj(),"yes"==$(".t706").attr("data-opencart-onorder")?setTimeout(function(){tcart__openCart()},10):($(".t706__carticon").addClass("t706__carticon_neworder"),setTimeout(function(){$(".t706__carticon").removeClass("t706__carticon_neworder")},2e3))}function tcart__updateTotalProductsinCartObj(){var t=window.tcart.products;if(0<t.length){var r=0,a=0;$.each(t,function(t,e){r+=+e.quantity,a=+a+ +e.amount}),a=tcart__roundPrice(a),window.tcart.total=r;var e=window.tcart.prodamount=a;if("object"==typeof window.tcart.promocode&&void 0!==window.tcart.promocode.promocode&&""!=window.tcart.promocode.promocode){var o=0;void 0!==window.tcart.promocode.discountsum&&0<window.tcart.promocode.discountsum?o=+window.tcart.promocode.discountsum:void 0!==window.tcart.promocode.discountpercent&&0<window.tcart.promocode.discountpercent?o=tcart__roundPrice(e*window.tcart.promocode.discountpercent*1/100):console.log("Cart Some error."),(e=tcart__roundPrice(e-=o))<0&&(e=0),window.tcart.prodamount_discountsum=o,window.tcart.prodamount_withdiscount=e}"object"==typeof window.tcart.delivery&&void 0!==window.tcart.delivery.price&&0<window.tcart.delivery.price&&0<window.tcart.prodamount&&(void 0!==window.tcart.delivery.freedl&&0<window.tcart.delivery.freedl&&e>=window.tcart.delivery.freedl||(e+=+window.tcart.delivery.price)),0<e&&(e=tcart__roundPrice(e)),window.tcart.amount=e}else window.tcart.total=0,window.tcart.prodamount=0,window.tcart.amount=0}function tcart__reDrawCartIcon(){var t=window.tcart,e=$(".t706__carticon");1==t.total&&(e.css("opacity",0),e.animate({opacity:1},300)),0<t.total?(e.addClass("t706__carticon_showed"),e.find(".t706__carticon-counter").html(t.total)):(e.removeClass("t706__carticon_showed"),e.find(".t706__carticon-counter").html("")),$(".t706__carticon-text").html("=&nbsp;"+tcart__showPrice(window.tcart.prodamount))}function tcart__openCart(){$(".t706__carticon").removeClass("t706__carticon_showed"),$("body").addClass("t706__body_cartwinshowed"),setTimeout(function(){tcart__lockScroll()},500),tcart__syncProductsObject__LStoObj();var t=$(".t706__cartwin");if(t.css("opacity",0),t.addClass("t706__cartwin_showed"),t.animate({opacity:1},300),tcart__reDrawProducts(),tcart__reDrawTotal(),$(document).keyup(tcart__keyUpFunc),"y"==window.lazy)try{t_lazyload_update()}catch(t){console.log("js lazyload not loaded")}}function tcart__reDrawProducts(){var t=$(".t706__cartwin-products"),e=window.tcart.products,r="";if(0<e.length&&$.each(e,function(t,e){""!=e.img&&(r="yes")}),0<e.length){var a="";$.each(e,function(t,e){a+='<div class="t706__product" data-cart-product-i="'+t+'">',"yes"==r&&(a+='<div class="t706__product-thumb"><div class="t706__product-imgdiv" style="background-image:url('+e.img+');"></div></div>'),a+='<div class="t706__product-title t-descr t-descr_sm">',a+=e.name,void 0!==e.options&&0<e.options.length&&(a+='<div style="opacity:0.7;font-size:12px;font-weight:400;">',$.each(e.options,function(t,e){a+="<div>"+e.option+": "+e.variant+"</div>"}),a+="</div>"),void 0!==e.sku&&""!=e.sku&&(a+='<div style="opacity:0.7;font-size:12px;font-weight:400;">',a+=e.sku,a+="</div>"),a+="</div>",void 0!==window.tcart_oneproduct&&"y"==window.tcart_oneproduct?a+='<div class="t706__product-plusminus t-descr t-descr_sm" style="display:none;"><span class="t706__product-quantity">'+e.quantity+"</span></div>":a+='<div class="t706__product-plusminus t-descr t-descr_sm"><span class="t706__product-minus"><img src="https://static.tildacdn.com/lib/linea/c8eecd27-9482-6c4f-7896-3eb09f6a1091/arrows_circle_minus.svg" style="width:16px;height:16px;border:0;"></span><span class="t706__product-quantity">'+e.quantity+'</span><span class="t706__product-plus"><img src="https://static.tildacdn.com/lib/linea/c47d1e0c-6880-dc39-ae34-521197f7fba7/arrows_circle_plus.svg" style="width:16px;height:16px;border:0;"></span></div>',a+='<div class="t706__product-amount t-descr t-descr_sm">',0<e.amount&&(a+=tcart__showPrice(e.amount)),a+="</div>",a+='<div class="t706__product-del"><img src="https://static.tildacdn.com/lib/linea/1bec3cd7-e9d1-2879-5880-19b597ef9f1a/arrows_circle_remove.svg" style="width:20px;height:20px;border:0;"></div>',a+="</div>"}),t.html(a),tcart__addEvents__forProducts()}else t.html("")}function tcart__reDrawTotal(){$(".t706__cartwin-prodamount").html(tcart__showPrice(window.tcart.prodamount)),$(".t706__cartwin-totalamount").html(tcart__showPrice(window.tcart.amount));var t=$(".t706__cartwin-totalamount-info");t.html(""),"object"!=typeof window.tcart.promocode&&"object"!=typeof window.tcart.delivery||(t.css("display","block"),t.append(tcart__dict(2,"Subtotal")+": "+tcart__showPrice(window.tcart.prodamount)+"<br>")),"object"==typeof window.tcart.promocode&&(t.append(tcart__dict(9,"Promo code")+": "+window.tcart.promocode.promocode+(void 0!==window.tcart.promocode.discountpercent?" "+window.tcart.promocode.discountpercent+"% ":"")+"<br>"),t.append(tcart__dict(10,"Discount")+": "+tcart__showPrice(window.tcart.prodamount_discountsum)+"<br>"),0<window.tcart.prodamount_withdiscount?t.append(tcart__dict(8,"Subtotal with discount")+": "+tcart__showPrice(window.tcart.prodamount_withdiscount)+"<br>"):t.append(tcart__dict(8,"Subtotal with discount")+": 0<br>")),"object"==typeof window.tcart.delivery&&void 0!==window.tcart.delivery.name&&void 0!==window.tcart.delivery.price&&0<window.tcart.delivery.price&&(void 0!==window.tcart.delivery.freedl&&0<window.tcart.delivery.freedl&&window.tcart.prodamount>=window.tcart.delivery.freedl&&(window.tcart.prodamount_withdiscount>=window.tcart.delivery.freedl||void 0===window.tcart.prodamount_withdiscount)?t.append(window.tcart.delivery.name+": 0 ("+tcart__dict(14,"free")+")<br>"):t.append(window.tcart.delivery.name+": "+tcart__showPrice(window.tcart.delivery.price)+"<br>")),0==window.tcart.prodamount?$(".t706__cartwin-prodamount-wrap").css("display","none"):$(".t706__cartwin-prodamount-wrap").css("display","block");var e=void 0!==window.tcart_minorder&&0<window.tcart_minorder,r=void 0!==window.tcart_mincntorder&&0<window.tcart_mincntorder;e&&r?(e&&(window.tcart.prodamount>=window.tcart_minorder?$(".t706__cartwin-prodamount-minorder").css("display","none"):($(".t706__cartwin-prodamount-minorder").css("display","block"),$(".t706").find(".t-submit").addClass("t706__submit_disable"))),r&&(window.tcart.total>=window.tcart_mincntorder?$(".t706__cartwin-prodamount-mincntorder").css("display","none"):($(".t706__cartwin-prodamount-mincntorder").css("display","block"),$(".t706").find(".t-submit").addClass("t706__submit_disable"))),window.tcart.prodamount>=window.tcart_minorder&&window.tcart.total>=window.tcart_mincntorder&&$(".t706").find(".t-submit").removeClass("t706__submit_disable")):(e&&(window.tcart.prodamount>=window.tcart_minorder?($(".t706__cartwin-prodamount-minorder").css("display","none"),$(".t706").find(".t-submit").removeClass("t706__submit_disable")):($(".t706__cartwin-prodamount-minorder").css("display","block"),$(".t706").find(".t-submit").addClass("t706__submit_disable"))),r&&(window.tcart.total>=window.tcart_mincntorder?($(".t706__cartwin-prodamount-mincntorder").css("display","none"),$(".t706").find(".t-submit").removeClass("t706__submit_disable")):($(".t706__cartwin-prodamount-mincntorder").css("display","block"),$(".t706").find(".t-submit").addClass("t706__submit_disable")))),0==window.tcart.amount?$(".t706__cartwin-totalamount-wrap").css("display","none"):window.tcart.prodamount==window.tcart.amount?$(".t706__orderform").length&&700<$(".t706__orderform").height()?$(".t706__cartwin-totalamount-wrap").css("display","block"):$(".t706__cartwin-totalamount-wrap").css("display","none"):$(".t706__cartwin-totalamount-wrap").css("display","block"),void 0!==window.tcart.promocode&&($(".t706__cartwin-totalamount-wrap").css("display","block"),0==window.tcart.amount&&$(".t706__cartwin-totalamount").html("0")),void 0!==window.tcart.delivery&&void 0!==window.tcart.delivery.price&&0<window.tcart.delivery.price&&$(".t706__cartwin-totalamount-wrap").css("display","block"),$(".t706__carticon-text").html("=&nbsp;"+tcart__showPrice(window.tcart.prodamount))}function tcart__addEvents__forProducts(){$(".t706__product-plus").click(function(){tcart__product__plus($(this))}),$(".t706__product-minus").click(function(){tcart__product__minus($(this))}),$(".t706__product-del").click(function(){tcart__product__del($(this))}),$(".t706__product-quantity").click(function(){tcart__product__editquantity($(this))})}function tcart__closeCart(){$("body").removeClass("t706__body_cartwinshowed"),tcart__unlockScroll(),void 0!==window.tcart_dontstore&&"y"==window.tcart_dontstore&&("undefind"!=typeof window.tcart&&"undefind"!=typeof window.tcart.products&&(window.tcart.products=[]),tcart__updateTotalProductsinCartObj(),tcart__saveLocalObj(),$(".t706__carticon-counter").html(window.tcart.total),tcart__reDrawTotal(),tcart__reDrawProducts()),0<window.tcart.total&&$(".t706__carticon").addClass("t706__carticon_showed"),tcart__delZeroquantity_inCartObj(),$(document).unbind("keyup",tcart__keyUpFunc),$(".t706__carticon").removeClass("t706__carticon_neworder"),$(".t706__cartwin").animate({opacity:0},300),setTimeout(function(){$(".t706__cartwin").removeClass("t706__cartwin_showed"),$(".t706__cartwin").css("opacity","1")},300),void 0!==window.tcart_success&&"yes"==window.tcart_success&&location.reload()}function tcart__keyUpFunc(t){27==t.keyCode&&tcart__closeCart()}function tcart__product__plus(t){var e=t.closest(".t706__product"),r=e.attr("data-cart-product-i");0<window.tcart.products[r].quantity&&void 0!==window.tcart.products[r].inv&&0<window.tcart.products[r].inv&&window.tcart.products[r].inv==window.tcart.products[r].quantity?alert(tcart__dict(13,"Sorry, limit reached, this is the maximum quantity of goods in stock")):(window.tcart.products[r].quantity++,window.tcart.products[r].amount=window.tcart.products[r].price*window.tcart.products[r].quantity,window.tcart.products[r].amount=tcart__roundPrice(window.tcart.products[r].amount),e.find(".t706__product-quantity").html(window.tcart.products[r].quantity),0<window.tcart.products[r].amount?e.find(".t706__product-amount").html(tcart__showPrice(window.tcart.products[r].amount)):e.find(".t706__product-amount").html(""),tcart__updateTotalProductsinCartObj(),$(".t706__carticon-counter").html(window.tcart.total),tcart__reDrawTotal(),tcart__saveLocalObj())}function tcart__product__minus(t){var e=t.closest(".t706__product"),r=e.attr("data-cart-product-i");0<window.tcart.products[r].quantity&&window.tcart.products[r].quantity--,window.tcart.products[r].amount=window.tcart.products[r].price*window.tcart.products[r].quantity,window.tcart.products[r].amount=tcart__roundPrice(window.tcart.products[r].amount),e.find(".t706__product-quantity").html(window.tcart.products[r].quantity),0<window.tcart.products[r].amount&&e.find(".t706__product-amount").html(tcart__showPrice(window.tcart.products[r].amount)),0==window.tcart.products[r].quantity&&tcart__product__del(t),tcart__updateTotalProductsinCartObj(),$(".t706__carticon-counter").html(window.tcart.total),tcart__reDrawTotal(),tcart__saveLocalObj()}function tcart__product__del(t){var e=t.closest(".t706__product"),r=e.attr("data-cart-product-i");window.tcart.products.splice(r,1),e.remove(),tcart__updateTotalProductsinCartObj(),$(".t706__carticon-counter").html(window.tcart.total),tcart__reDrawTotal(),tcart__saveLocalObj(),tcart__reDrawProducts(),0==window.tcart.products.length&&tcart__closeCart()}function tcart__product__editquantity(e){if(!e.find(".t706__product-quantity-inp").length){var r=e.closest(".t706__product"),a=r.attr("data-cart-product-i"),t=e.text(),o='<input type="text" name="tilda-tmp-cart-qnt" class="t706__product-quantity-inp" value="'+(0==t||0<t?parseInt(t,10):1)+'" style="width:30px;">';e.html(o),e.addClass("t706__product-quantity_editing");var i=e.find(".t706__product-quantity-inp");i.focus(function(){var t=this;setTimeout(function(){t.selectionStart=t.selectionEnd=1e4},0)}),i.focus(),i.focusout(function(){var t=i.val();t=parseInt(t,10),tcart__product__updateQuantity(e,r,a,0<t?t:1),e.text(window.tcart.products[a].quantity),e.removeClass("t706__product-quantity_editing")})}}function tcart__product__updateQuantity(t,e,r,a){0<a?(void 0!==window.tcart.products[r].inv&&0<window.tcart.products[r].inv&&a>window.tcart.products[r].inv&&(alert(tcart__dict(13,"Sorry, limit reached, this is the maximum quantity of goods in stock")),a=window.tcart.products[r].inv),window.tcart.products[r].quantity=a,window.tcart.products[r].amount=window.tcart.products[r].price*window.tcart.products[r].quantity,window.tcart.products[r].amount=tcart__roundPrice(window.tcart.products[r].amount),e.find(".t706__product-quantity").html(window.tcart.products[r].quantity),0<window.tcart.products[r].amount?e.find(".t706__product-amount").html(tcart__showPrice(window.tcart.products[r].amount)):e.find(".t706__product-amount").html("")):tcart__product__del(t),tcart__updateTotalProductsinCartObj(),$(".t706__carticon-counter").html(window.tcart.total),tcart__reDrawTotal(),tcart__saveLocalObj(),0==a&&tcart__reDrawProducts()}function tcart__delZeroquantity_inCartObj(){var t=window.tcart.products,r="";0<t.length&&$.each(t,function(t,e){void 0!==e&&0==e.quantity&&(window.tcart.products.splice(t,1),r="yes")}),"yes"==r&&tcart__saveLocalObj()}function tcart__drawBottomTotalAmount(){$(".t706 .t-form__errorbox-middle").before('<div class="t706__cartwin-totalamount-wrap t-descr t-descr_xl"><div class="t706__cartwin-totalamount-info" style="font-size:14px; padding-bottom:10px; font-weight:400;"></div><span class="t706__cartwin-totalamount-label">Total:&nbsp;</span><span class="t706__cartwin-totalamount"></span></div>')}function tcart__addDelivery(){var t=$(".t706 .t-form .t-radio__wrapper-delivery");if(0!==t.length){var e=$(".t706 .t-form .t-radio__wrapper-delivery input:checked").val(),r=$(".t706 .t-form .t-radio__wrapper-delivery input:checked").attr("data-delivery-price"),a=$(".t706 .t-form .t-radio__wrapper-delivery .t-radio_delivery:checked").attr("data-service-id");if(void 0!==e&&void 0!==r&&""!=e){r=tcart__cleanPrice(r);var o=e.indexOf("=");0<o&&(e=(e=e.substring(0,o)).trim()),window.tcart.delivery={},window.tcart.delivery.name=e,window.tcart.delivery.price=r,a&&(window.tcart.delivery.service_id=a),console.log("set delivery price"),void 0!==(t=$(".t706 .t-form .t-radio__wrapper-delivery")).attr("data-delivery-free")&&0<t.attr("data-delivery-free")&&(window.tcart.delivery.freedl=parseInt(t.attr("data-delivery-free"),10))}var i=$(".t706 .t-form .t-radio__wrapper-delivery input");i.length&&i.change(function(){tcart__updateDelivery()})}}function tcart__updateDelivery(){console.log("update delivery price");var t=$(".t706 .t-form .t-radio__wrapper-delivery input:checked").val(),e=$(".t706 .t-form .t-radio__wrapper-delivery input:checked").attr("data-delivery-price");if(void 0!==t&&void 0!==e){if(e=tcart__cleanPrice(e),""!=t){var r=t.indexOf("=");0<r&&(t=(t=t.substring(0,r)).trim())}window.tcart.delivery={},window.tcart.delivery.name=t,window.tcart.delivery.price=e;var a=$(".t706 .t-form .t-radio__wrapper-delivery");void 0!==a.attr("data-delivery-free")&&0<a.attr("data-delivery-free")&&(window.tcart.delivery.freedl=parseInt(a.attr("data-delivery-free")))}else void 0!==window.tcart.delivery&&delete window.tcart.delivery;tcart_newDelivery.fillTcartDelivery(),tcart__updateTotalProductsinCartObj(),tcart__reDrawTotal()}function tcart__addPromocode(t){"object"!=typeof window.tcart.promocode?("object"==typeof t&&void 0!==t.promocode&&""!=t.promocode&&(0<t.discountsum||0<t.discountpercent)&&(window.tcart.promocode=t),tcart__updateTotalProductsinCartObj(),tcart__reDrawTotal()):console.log("Error. Promocode already activated before")}function tcart__addEvent__selectpayment(){if(0!=$(".t706").find(".t-input-group_pm").length){var t=$(".t706 .t-form .t-radio__wrapper-payment input");t.length&&(t.change(function(){var t=$(".t706 .t-form .t-radio__wrapper-payment input:checked").attr("data-payment-variant-system");void 0!==t&&""!=t||(t=""),$(".t706").attr("data-payment-variant-system",t),window.tcart.system=t}),$(".t706 .t-form .t-radio__wrapper-payment input:checked").trigger("change"))}}function tcart__escapeHtml(t){var e={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[<>"']/g,function(t){return e[t]})}function tcart__escapeHtmlImg(t){var e={"<":"&lt;",">":"&gt;",'"':"&quot;"};return t.replace(/[<>"]/g,function(t){return e[t]})}function tcart__cleanPrice(t){return void 0===t||""==t||0==t?t=0:(t=(t=t.replace(",",".")).replace(/[^0-9\.]/g,""),t=parseFloat(t).toFixed(2),isNaN(t)&&(t=0),(t=+(t=parseFloat(t)))<0&&(t=0)),t}function tcart__roundPrice(t){return void 0===t||""==t||0==t?t=0:(t=parseFloat(t).toFixed(2),(t=+(t=parseFloat(t)))<0&&(t=0)),t}function tcart__showPrice(t){if(void 0===t||0==t||""==t)t="";else{if(t=t.toString(),void 0!==window.tcart.currency_dec&&"00"==window.tcart.currency_dec)if(-1===t.indexOf(".")&&-1===t.indexOf(","))t+=".00";else 1===t.substr(t.indexOf(".")+1).length&&(t+="0");t=t.replace(/\B(?=(\d{3})+(?!\d))/g," "),void 0!==window.tcart.currency_sep&&","==window.tcart.currency_sep&&(t=t.replace(".",",")),t=window.tcart.currency_txt_l+t+window.tcart.currency_txt_r}return t}function tcart__lockScroll(){if(/iPhone|iPad|iPod/i.test(navigator.userAgent)&&!window.MSStream){var t=$("body");if(!t.hasClass("t-body_scroll-locked")){var e=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;t.addClass("t-body_scroll-locked"),t.css("top","-"+e+"px"),t.attr("data-popup-scrolltop",e)}}}function tcart__unlockScroll(){if(/iPhone|iPad|iPod/i.test(navigator.userAgent)&&!window.MSStream){var t=$("body");if(t.hasClass("t-body_scroll-locked")){var e=$("body").attr("data-popup-scrolltop");t.removeClass("t-body_scroll-locked"),t.css("top",""),t.removeAttr("data-popup-scrolltop"),window.scrollTo(0,e)}}}function tcart__clearProdUrl(){try{var t=window.location.href;if(e=t.indexOf("#!/tproduct/"),/iPhone|iPad|iPod/i.test(navigator.userAgent)&&e<0&&(e=t.indexOf("%23!/tproduct/"))<0&&(e=t.indexOf("#%21%2Ftproduct%2F")),e<0){var e=t.indexOf("/tproduct/");e<0&&(e=t.indexOf("%2Ftproduct%2F"))}if(e<0)return;t=t.substring(0,e),void 0!==history.replaceState&&window.history.replaceState("","",t)}catch(t){}}